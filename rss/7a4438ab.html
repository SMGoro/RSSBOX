<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta name="generator" content="Hexo 6.3.0">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.19.0">
  <meta charset="utf-8">
  

  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="dns-prefetch" href="https://gcore.jsdelivr.net">
  <link rel="preconnect" href="https://gcore.jsdelivr.net" crossorigin>
  <link rel="dns-prefetch" href="//unpkg.com">

  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>Attacking Browser Extensions - RSSBOX</title>

  
    <meta name="description" content="Browser extensions first became mainstream in the early 2000s with their adoption by Firefox and Chromium and their popularity has been growing ever since. Nowadays, it is common for even the avera">
<meta property="og:type" content="article">
<meta property="og:title" content="Attacking Browser Extensions">
<meta property="og:url" content="https://blog.imc.re/RSSBOX/rss/7a4438ab.html">
<meta property="og:site_name" content="RSSBOX">
<meta property="og:description" content="Browser extensions first became mainstream in the early 2000s with their adoption by Firefox and Chromium and their popularity has been growing ever since. Nowadays, it is common for even the avera">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/action-extension.png?w=1024&amp;resize=1024%2C936">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/ublock-origin.png?w=906&amp;resize=906%2C450">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/permissions.png?w=842&amp;resize=842%2C492">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/image11.png?w=1024&amp;resize=1024%2C642">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/image3_238cc9.png?w=862&amp;resize=862%2C490">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/image4.png?w=508&amp;resize=508%2C872">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/image6.png?w=845&amp;resize=845%2C508">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/image5.png?w=736&amp;resize=736%2C558">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/image8.png?w=1024&amp;resize=1024%2C394">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/image12.png?w=1024&amp;resize=1024%2C240">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/image10.png?w=1024&amp;resize=1024%2C303">
<meta property="og:image" content="https://github.blog/wp-content/uploads/2024/10/image2_6190c0.png?w=1024&amp;resize=1024%2C315">
<meta property="article:published_time" content="2024-10-24T10:15:02.000Z">
<meta property="article:modified_time" content="2024-10-24T10:15:02.000Z">
<meta property="article:author" content="SMGoro">
<meta property="article:tag" content="Blogs">
<meta property="article:tag" content="Github">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://github.blog/wp-content/uploads/2024/10/action-extension.png?w=1024&amp;resize=1024%2C936">
  
  
  
  <meta name="keywords" content="Blogs,Github">

  <!-- feed -->
  
    <link rel="alternate" href="/RSSBOX/atom.xml" title="RSSBOX" type="application/atom+xml">
  

  
    
<link rel="stylesheet" href="/RSSBOX/css/main.css">

  

  

  

  
    <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
    <script defer src="https://gcore.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
    <script defer src="https://gcore.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
  


  

<!--百度统计-->
<script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?f42afe3e5b76d22c8b1a8060171c7184";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>  
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V2NSKYGXNG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V2NSKYGXNG');
</script>
<!--Google Adsense-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4773172018528901" crossorigin="anonymous"></script>
</head>

<body>
  




  <div class="l_body" id="start">
    <aside class="l_left" layout="post">
    

  

<header class="header"><div class="logo-wrap"><a class="avatar" href="/RSSBOX/archives"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="https://cdn.jsdelivr.net/gh/SMGCDN/photos/icon/rsshub.png" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/image/2659360.svg';"></a><a class="title" href="/RSSBOX/"><div class="main" ff="title">RSSBOX</div><div class="sub normal cap">SMGoroのRSS订阅</div><div class="sub hover cap" style="opacity:0"> 一些好康的东西</div></a></div>

<nav class="menu dis-select"><a class="nav-item active" href="/RSSBOX/">订阅</a><a class="nav-item" href="https://blog.imc.re/">博客</a><a class="nav-item" href="https://blog.imc.re/contact">联系</a><a class="nav-item" href="https://blog.imc.re/more">更多</a></nav>
</header>


<div class="widgets">

<widget class="widget-wrapper toc single" id="data-toc"><div class="widget-header cap dis-select"><span class="name">Attacking Browser Extensions</span></div><div class="widget-body fs14"><div class="doc-tree active"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#the-extension-structure"><span class="toc-text">The extension structure</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#background-script-and-permissions"><span class="toc-text">Background script and permissions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#content-scripts"><span class="toc-text">Content scripts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#popup-context"><span class="toc-text">Popup context</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#attack-surface"><span class="toc-text">Attack surface</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vulnerabilities"><span class="toc-text">Vulnerabilities</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cross-site-scripting"><span class="toc-text">Cross-site scripting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ssrf"><span class="toc-text">SSRF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#extension-api-injection"><span class="toc-text">Extension API injection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mitigations"><span class="toc-text">Mitigations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#uuid-randomization"><span class="toc-text">UUID randomization</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#modeling-with-codeql"><span class="toc-text">Modeling with CodeQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#real-world-attack"><span class="toc-text">Real-world attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#conclusion"><span class="toc-text">Conclusion</span></a></li></ol></div></div></widget>



<widget class="widget-wrapper search"><div class="widget-body"><div class="search-wrapper" id="search"><form class="search-form"><input type="text" class="search-input" id="search-input" data-filter="/rss/" placeholder="文章搜索"><svg t="1670596976048" class="icon search-icon" viewbox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2676" width="200" height="200"><path d="M938.2 832.6L723.8 618.1c-2.5-2.5-5.3-4.4-7.9-6.4 36.2-55.6 57.3-121.8 57.3-193.1C773.3 222.8 614.6 64 418.7 64S64 222.8 64 418.6c0 195.9 158.8 354.6 354.6 354.6 71.3 0 137.5-21.2 193.2-57.4 2 2.7 3.9 5.4 6.3 7.8L832.5 938c14.6 14.6 33.7 21.9 52.8 21.9 19.1 0 38.2-7.3 52.8-21.8 29.2-29.1 29.2-76.4 0.1-105.5M418.7 661.3C284.9 661.3 176 552.4 176 418.6 176 284.9 284.9 176 418.7 176c133.8 0 242.6 108.9 242.6 242.7 0 133.7-108.9 242.6-242.6 242.6" p-id="2677"/></svg></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div></div></widget>



<widget class="widget-wrapper recent"><div class="widget-header cap theme dis-select"><span class="name">最近更新</span><a class="cap-action" id="rss" title="Subscribe" href="/atom.xml"><svg class="icon" viewbox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8938"><path d="M800.966 947.251c0-404.522-320.872-732.448-716.69-732.448V62.785c477.972 0 865.44 395.987 865.44 884.466h-148.75z m-162.273 0h-148.74c0-228.98-181.628-414.598-405.678-414.598v-152.01c306.205 0 554.418 253.68 554.418 566.608z m-446.24-221.12c59.748 0 108.189 49.503 108.189 110.557 0 61.063-48.44 110.563-108.188 110.563-59.747 0-108.18-49.5-108.18-110.563 0-61.054 48.433-110.556 108.18-110.556z" p-id="8939"/></svg></a></div><div class="widget-body related-posts fs14"><a class="item title" href="/RSSBOX/rss/9478a4fa.html"><span class="title">I Got My Wish and Reincarnated as the Villainess (Last Boss)! 001-024 as V01-03 (Digital-Compilation) (Oan) [Oak]</span></a><a class="item title" href="/RSSBOX/rss/81997030.html"><span class="title">Keiken Zumi Na Kimi To, Keiken Zero Na Ore Ga, Otsukiai Suru Hanashi / You Were Experienced, I Was Not: Our Dating Story V01-05 [J-Novel Club] [Antithetical]</span></a><a class="item title" href="/RSSBOX/rss/2e17acd3.html"><span class="title">Trillion Game - 05 「乙女の眼差し」 (TBS 1920x1080 X264 AAC).mkv</span></a><a class="item title" href="/RSSBOX/rss/7bd92795.html"><span class="title">Sayonara Ryuusei, Konnichiwa Jinsei - 03 「女剣士」 (TBS 1920x1080 X264 AAC).mkv</span></a><a class="item title" href="/RSSBOX/rss/da1442de.html"><span class="title">Aldnoah.Zero (2024) - 16 「熱砂の進撃 -Soldiers' Pay-」 (BS11 1920x1080 X264 AAC).mp4</span></a></div></widget>
</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://github.com/SMGoro" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/SMGCDN/photos/icon/iconfont/social-github.svg"></a><a class="social" href="https://space.bilibili.com/359079394" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/SMGCDN/photos/icon/iconfont/bilibili.svg"></a><a class="social" href="https://l.imc.re/zhihu" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/SMGCDN/photos/icon/iconfont/zhihu.svg"></a><a class="social" href="https://l.imc.re/discord" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/SMGCDN/photos/icon/iconfont/discord.svg"></a><a class="social" href="https://blog.imc.re/contact" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/SMGCDN/photos/icon/iconfont/comments.svg"></a></div></footer>

    </aside>
    <div class="l_main">
      

      



<div class="bread-nav fs12"><div id="breadcrumb"><a class="cap breadcrumb" href="/RSSBOX/">主页</a><span class="sep"></span><a class="cap breadcrumb" href="/RSSBOX/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/RSSBOX/categories/blogs/">Blogs</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/RSSBOX/categories/blogs/github/">Github</a></div><div id="post-meta">发布于&nbsp;<time datetime="2024-10-24T10:15:02.000Z">2024-10-24</time></div></div>

<article class="md-text content post">
<h1 class="article-title"><span>Attacking Browser Extensions</span></h1>
<div>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">

<html><body><p>Browser extensions first became mainstream in the early 2000s with their adoption by Firefox and Chromium and their popularity has been growing ever since. Nowadays, it is common for even the average user to have at least one extension installed, often an adblocker. Research into the security of browser extensions is mostly scattered around between individual bug reports and coverage on malicious chrome extensions. In this blog, I will introduce the structure of a browser extension and the vulnerabilities that are present in the ecosystem. I will then discuss the progression of security in the extension space, highlighting the attack surface and its relationship with mitigations that have been implemented. Lastly, I will recommend some CodeQL queries and best practices that users, developers and researchers can use to ensure the security of their extension.</p>
<h2 id="the-extension-structure">The extension structure<a aria-label="The extension structure" class="heading-link pl-2 text-italic text-bold" href="#the-extension-structure"></a></h2>
<p>Mozilla and Google, and their respective browsers, Firefox and Chromium, set the standard for most browser extensions (note, we will not cover Apple’s Safari here). Throughout this blog, I will talk about extension core concepts, and highlight the differences between Firefox and Chromium. The differences between Firefox and Chromium are manifested in the differences in policy on what is allowed on the corresponding extension stores and how extensions interact with the browser, which ultimately decide the security and safety of extension for the end user.</p>
<p>A browser extension is a group of HTML, CSS, and JavaScript files that work together to enhance the browsing experience. Usually, the code runs in its own domain, the domain labeled by the extensions ID. For example, the Chromium extension uBlock origin <a target="_blank" rel="external nofollow noopener noreferrer" href="https://chromewebstore.google.com/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm">https://chromewebstore.google.com/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm</a> will run in the domain <code>cjpalhdlnbpafiamejdnhcphjbkeiagm</code>, which the Chromium web store makes obvious via the URL. Extension URLs vary depending on the browser, but generally follow the pattern: <code>browser_specific_extension_scheme://extension_id/actual_resource_nam<em>e</em></code>. If you want to access the popup present on uBlock origin Chromium extension, you can use the URL: <code><em>chrome-extension://cjpalhdlnbpafiamejdnhcphjbkeiagm/popup-fenix.html</em></code>.</p>
<p>Besides the HTML, CSS and JavaScript files, an extension also has one important settings file, named <code>manifest.json</code>. This is a required file that lists the identification of the extension, permissions required of the extension, and the accessibility of the extension. As the ecosystem of browsers have progressed, the version of the <code>manifest.json</code> has also progressed, with new versions often enforcing more secure settings and making changes to the nomenclature. In the next section, we will discuss the contexts an extension’s files can run in and how this can be directed via the manifest file.</p>
<p>In the <code>manifest.json</code> file, we can specify the context that a file will run. The three major contexts are the webpage/content script, the popup and the background. You can let the browser know which context you want the file to run in by specifying it in the <code>manifest.json</code> file, aptly labeled <code>content_scripts</code>, <code>background_script</code>, and <code>browser_action</code> in the manifest version 2 (v2). On manifest version 3 (v3), a <code>manifest.json</code> may look like the following:</p>
<p><img><img alt="Screenshot of a manifest.json file showing minor changes between versions." class="aligncenter size-large wp-image-80685 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" fetchpriority="high" height="936" sizes="(max-width: 1000px) 100vw, 1000px" src="https://github.blog/wp-content/uploads/2024/10/action-extension.png?w=1024&amp;resize=1024%2C936" width="1024"></p>
<p>Here, you can see how the v2 permissions have changed slightly to their v3 counterparts: <code>content_scripts</code>, <code>background</code> and <code>action</code>, showing the minor changes between versions.</p>
<h3 id="background-script-and-permissions">Background script and permissions<a aria-label="Background script and permissions" class="heading-link pl-2 text-italic text-bold" href="#background-script-and-permissions"></a></h3>
<p>Let’s start by talking about the background context. The background context is the most powerful of the three contexts with the ability to access most of the <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs">browser extension APIs</a>/<a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API">WebExtensions API</a>. From now on, I will refer to both <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs">browser extension APIs</a> and <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API">WebExtensions API</a> as the Extension APIs for the sake of brevity. The Extension APIs give an extension a lot of control of the user’s browsing experience, with the ability to arbitrarily control tabs, read from the websites, or modify and read cookies, to name a few. Luckily, these abilities are each locked behind permissions, requested in the <code>manifest.json</code> file under the “permissions” key. When installing an extension, a popup will show up describing in a user friendly way which permissions an extension will be granted.</p>
<p><img><img alt="Screenshot of the popup describing which permissions the uBlock Origin extension will be granted." class="aligncenter size-large wp-image-80686 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="450" sizes="(max-width: 906px) 100vw, 906px" src="https://github.blog/wp-content/uploads/2024/10/ublock-origin.png?w=906&amp;resize=906%2C450" width="906"></p>
<p>There are some important permissions to look out for during a security review of an extension. Firstly, look for the permissions key in <code>manifest.json</code>, whose values are a combination of hosts and actual permissions in manifest version 2.</p>
<p><img><img alt="Screenshot of the permissions key in manifest.json" class="aligncenter size-large wp-image-80687 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="492" sizes="(max-width: 842px) 100vw, 842px" src="https://github.blog/wp-content/uploads/2024/10/permissions.png?w=842&amp;resize=842%2C492" width="842"></p>
<p>In this example, the extension can access all URLs, which can be specified through regex or through the keyword <code>all_urls</code>. When an extension has permissions for a domain, it will allow the extension to send requests to the domain with all cookies, ignoring some security considerations. For example, if the website puts some SameSite strict cookies in the browser, the extension can still make requests on your behalf with those cookies despite being part of a separate domain. In v3, domain permissions are moved to <code>host_permissions</code> and additional optional permissions are introduced, which are requested during runtime based on user consent. A v3 manifest may look like:</p>
<p><img><img alt="Screenshot of a v3 manifest" class="aligncenter size-large wp-image-80688 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="642" loading="lazy" sizes="(max-width: 1000px) 100vw, 1000px" src="https://github.blog/wp-content/uploads/2024/10/image11.png?w=1024&amp;resize=1024%2C642" width="1024"></p>
<p>Some important permissions to look for are those that include user sensitive information, such as <em>history</em>, <em>bookmarks</em>, <em>cookies</em> or <em>permissions</em> or ones that give the extension more control over the browser, such as <em>downloads</em>, <em>management</em>, or <em>tab</em>. One permission that has a lot of power is the <em>activeTab</em> permission, allowing the extension to inject JavaScript code into any domain that the user is currently interacting with. In order to inject into the current tab, it must have user interaction. This <em>activeTab</em> is interesting for exploitation and malicious extensions alike due to its immense power. If malicious input can be injected into the executed JavaScript, the attacker may get the ability to get Universal XSS (UXSS). A malicious extension, on the other hand, can create shortcuts that overlap with common user actions, such as copy or paste, and interact with tabs it is not supposed to have access to. The permissions of an extension are a great way to start assessing an extension to see if it even has enough privileges to perform actions that may pose a risk. The background script should be audited to ensure the safety of calls to the browser APIs, and analyzed to see how messages are sent back to the content scripts.</p>
<h3 id="content-scripts">Content scripts<a aria-label="Content scripts" class="heading-link pl-2 text-italic text-bold" href="#content-scripts"></a></h3>
<p>The frontend of an extension is just as important as the backend when extensions want to interact with the DOM of the pages visited by the user, a responsibility that a background script cannot achieve due to its lack of access to the DOM. This is where content scripts come into play. The content script runs in the context of the website but lives in an <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.chrome.com/docs/extensions/develop/concepts/content-scripts#isolated_world">isolated world</a>, where “JavaScript variables in an extension’s content scripts are not visible to the host page or other extensions’ content scripts.” For example, if an extension wanted to add the summary of a page to the top to help readability, the code may look something like this.</p>
<p><img><img alt="Sample code adding a summary of a page to the top to help readability" class="aligncenter size-large wp-image-80689 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="490" loading="lazy" sizes="(max-width: 862px) 100vw, 862px" src="https://github.blog/wp-content/uploads/2024/10/image3_238cc9.png?w=862&amp;resize=862%2C490" width="862"></p>
<p>The content script may also listen for user interaction on the current page, allowing an action to be taken based on the user interaction. For example, some extensions translate text present on the current page, based on the user’s highlight or focus on a certain word or phrase. The content script and background script work in harmony in order to create the extension’s intended experience.</p>
<h3 id="popup-context">Popup context<a aria-label="Popup context" class="heading-link pl-2 text-italic text-bold" href="#popup-context"></a></h3>
<p>Lastly, the popup context is present for the HTML and JavaScript that makes up the menu that “pops up” when you click on the icon of the extension. Often, the popup will let the user directly interact with the functionality of the extension, usually allowing them to change settings and make requests to backend servers that are tied to the extension.</p>
<p><img><img alt="Screenshot of a uBlock Origin popup for a Google Docs page, showing what has been blocked and allowing the user to interact directly with the extension. " class="aligncenter size-large wp-image-80690 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="872" loading="lazy" sizes="(max-width: 508px) 100vw, 508px" src="https://github.blog/wp-content/uploads/2024/10/image4.png?w=508&amp;resize=508%2C872" width="508"></p>
<p>For example, in the uBlock origin popup, we can click on different icons to access the options page, disable fonts and JavaScript, or disable the extension on the current website.</p>
<p>The popup page, along with the other HTML pages included in the extension, can be a critical source of interest. For example, MetaMask is a crypto wallet extension. If a website can cover the extension, a malicious website can trick the user into signing transactions and thus result in the loss of funds.</p>
<p><img><img alt="Screenshot of two popups from the the crypto wallet extension MetaMask." class="aligncenter size-large wp-image-80691 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="508" loading="lazy" sizes="(max-width: 845px) 100vw, 845px" src="https://github.blog/wp-content/uploads/2024/10/image6.png?w=845&amp;resize=845%2C508" width="845"></p>
<p>Like the background script, the JavaScript running in the popup page can use all the Extensions APIs that the extension has permissions for and any JavaScript runs in the domain of the extension.</p>
<h2 id="attack-surface">Attack surface<a aria-label="Attack surface" class="heading-link pl-2 text-italic text-bold" href="#attack-surface"></a></h2>
<p>Because browser extensions are made from HTML, CSS, and JavaScript, they are vulnerable to many of the classic JavaScript vulnerabilities. I will first introduce the attack surface of v2 extensions because it is a superset of v3, then I will conclude by talking about the mitigations brought about in v3 and how it restricts the attacker. I will also write about browser specific implementations and how they affect security.</p>
<p>All attacks must start from an attacker-controlled source, and the extension interacts with two main attacker-controlled sources:</p>
<ol>
<li>A website loaded by the user</li>
<li>Other installed extensions</li>
</ol>
<p>The most common attack surface in the content script occurs when data is parsed from the current website and the script injects the data into the document as HTML. Some extensions extract the DOM text and attempt to make changes, often to beautify the text or to use the data in some way, then return the DOM text back to the webpage. If the extension allows the text to be inserted back into the page as HTML, we can get an XSS vulnerability in the website. However, this has the prerequisite that the extracted DOM text is controlled by an attacker. Common cases may include when a user comments on a website, or on websites that allow user uploaded content like many social media sites.</p>
<p>Secondly, an extension can interact with another extension by calling the <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage">sendMessage</a> API to send a message and <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnectExternal">onConnectExternal</a>/<a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessageExternal">onMessageExternal</a> APIs to receive a message. If the extension does not check the sender, a malicious extension may be able to access any functionality that the onMessageExternal/onConnectExternal function facilitates.</p>
<p>Depending on the configuration of the manifest, new vulnerabilities can be introduced. Let’s see some of those.</p>
<p><img><img alt="external_connectable property" class="aligncenter size-large wp-image-80692 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="558" loading="lazy" sizes="(max-width: 736px) 100vw, 736px" src="https://github.blog/wp-content/uploads/2024/10/image5.png?w=736&amp;resize=736%2C558" width="736"></p>
<p>The <code>external_connectable</code> property allows an extension to be connected to by a given website or extension ID. Here we can see how <code>onMessageExternal</code>/<code>onConnectExternal</code> can be extremely dangerous if there is a misconfiguration, as the functionality that was only meant for other extensions is now available to websites.</p>
<p>Another interesting configuration property is the <code>web_accessible_resources</code>:</p>
<p><img><img alt="web_accessible_resources code" class="aligncenter size-large wp-image-80693 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="394" loading="lazy" sizes="(max-width: 1000px) 100vw, 1000px" src="https://github.blog/wp-content/uploads/2024/10/image8.png?w=1024&amp;resize=1024%2C394" width="1024"></p>
<p>This property opens up an extension up to a greater attack surface by introducing two new possible attack vectors. If an HTML file is web accessible, then a website can load the HTML file in an iframe. If the page takes URL parameters and uses them in any privileged way, a malicious website may be able to make privileged actions. Secondly, if the HTML page allows for sensitive actions and is web accessible a clickjacking vulnerability is possible, where the website will cover the iframe and get the user to input or click on privileged operations. More information on clickjacking can be found on <a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.lizzie.io/clickjacking-privacy-badger.html">this great blog post</a> showing an attack on Privacy Badger.</p>
<p>Thus, our three attack surfaces boil down to:</p>
<ol>
<li>The extension takes attacker-supplied input from the website and uses it in some unsafe way.</li>
<li>Another extension or a website sends a message to the extension and the extension uses that input in a dangerous way.</li>
<li>The extension takes in URL parameters when it is loaded, and those parameters are used to do a privileged operation. This requires a vulnerable configuration.</li>
</ol>
<p>A quick assessment of all these vulnerabilities shows us why browser extensions are generally pretty secure, because it often requires multiple points of failure in order to introduce an exploitable vulnerability. Often, a misconfiguration is needed alongside a vulnerability in order to make the vulnerability truly exploitable.</p>
<p>Next, we will take a look at the possible vulnerabilities that occur in a browser extension, and the mitigations that browser developers have developed to mitigate these issues.</p>
<h2 id="vulnerabilities">Vulnerabilities<a aria-label="Vulnerabilities" class="heading-link pl-2 text-italic text-bold" href="#vulnerabilities"></a></h2>
<h3 id="cross-site-scripting">Cross-site scripting<a aria-label="Cross-site scripting" class="heading-link pl-2 text-italic text-bold" href="#cross-site-scripting"></a></h3>
<p>Cross-site scripting vulnerabilities are present across many web applications, and are present in browser extensions as well. XSS can occur in two contexts, in the context of the content script and in the context of the background script. An XSS gives the attacker the same privileges as the running JavaScript, therefore an XSS in the context of the content script allows the attacker to compromise the user on that specific website. In contrast, an XSS in the context of the background script allows the attacker to call any Extension API the extension has permissions for, and thus gives the attacker much more control over the entire browser (for example, UXSS).</p>
<p>In order to talk about XSS, we must talk about the Content Security Policy (CSP). On manifest v2 and v3 of extensions, the <code>unsafe-inline</code> directive is not allowed in the extension. Therefore, any HTML pages that are part of the extension such as the popup, the options page or any other, are immune from XSS. They are, however, still vulnerable to HTML injection attacks. However, the <code>unsafe-eval</code> attribute is still allowed on manifest v2 but has since been deprecated in manifest v3. When looking for XSS vulnerabilities in extensions, check if the manifest contains the <code>unsafe-eval</code> directive.</p>
<p><img><img alt="When looking for XSS vulnerabilities in extensions, check if the manifest contains the unsafe-eval directive." class="aligncenter size-large wp-image-80694 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="240" loading="lazy" sizes="(max-width: 1000px) 100vw, 1000px" src="https://github.blog/wp-content/uploads/2024/10/image12.png?w=1024&amp;resize=1024%2C240" width="1024"></p>
<p>Then, look for functions that execute code such as <code>eval()</code>, <code>Function()</code>, <code>setTimeout()</code>, <code>setInterval()</code>, etc. Another function to look out for is the Extension API  function <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript">executeScript</a>. On manifest v2, the API is <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript">tabs.executeScript()</a> and allows taking in a string as code, so it is just like the <code>eval()</code> function. Manifest v3 has removed this API, introducing a new API called <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/scripting/executeScript">scripting.executeScript()</a> which only allows local files to be executed. Generally speaking, outdated Firefox extensions are much more likely to be vulnerable to XSS, as Firefox AddOn Store is still accepting new manifest v2 extensions and thus has access to <code>unsafe-eval</code> directive and the <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript">tabs.executeScript()</a> API. Many actively developed extensions even have a Firefox v2 and Chromium v3 extension, due to Google’s push for the new version. I want to shout out this <a target="_blank" rel="external nofollow noopener noreferrer" href="https://palant.info/2022/08/24/attack-surface-of-extension-pages/">article</a> by Wladimir Palant, which goes into detail about the possible vulnerabilities that occur when using old versions of jQuery and <code>unsafe-eval</code>, and shows some code demonstrating the attacks.</p>
<h3 id="ssrf">SSRF<a aria-label="SSRF" class="heading-link pl-2 text-italic text-bold" href="#ssrf"></a></h3>
<p>Server-Side request forgery is a common vulnerability found in web applications, and we can also find them in browser extensions. Browser extensions are similar to web applications, but run with the cookies of a client-side browser. If an attacker is able to influence the URL of a network request such as <code>XMLHTTPRequest</code> or <code>fetch</code>, it is possible that an SSRF can result. The effect of the SSRF will depend on the specified method, whether the extension developer makes the request with credentials/cookies, and whether the manifest of the extension has that website allowed in the <code>permissions</code>/<code>host_permissions</code> entry.</p>
<p>In its move from v2 to v3, changes to an extension’s ability to make requests have been implemented. Specifically on manifest v2 and on Firefox, an extension with no permissions is able to send requests to arbitrary domains with cookies, but is not able to send SameSite cookies, which is reserved for those with the correct permissions. In Chromium, an extension with no permissions cannot send requests with cookies. In contrast, v3 extensions require the <code>host_permissions</code> in order to send any cookies with the request. This means that SSRF with v2 in Firefox is much more powerful than with v3, depending on the security of the website you are targeting. This, along with Firefox’s lack of enforcement for new extensions to be v3 in the addons store, makes Firefox extensions more vulnerable to SSRF attacks than Chromium.</p>
<h3 id="extension-api-injection">Extension API injection<a aria-label="Extension API injection" class="heading-link pl-2 text-italic text-bold" href="#extension-api-injection"></a></h3>
<p>Injection into the Extension APIs is a vulnerability unique to browser extensions. If attacker-controlled data is able to be injected into an API call, an attacker may gain the abilities of the extension. Generally, the APIs fall into two categories, those that change data and those that leak data. Some of the APIs that allow you to change data include <code>downloads.download()</code>, the bookmark create or remove function, and even the cookies <code>set</code> function. Unsurprisingly, these APIs are made with safe defaults present. The <code>download</code> method can only download to the user-defined Downloads folder, and is sanitized from path traversal and the like.</p>
<p>Another example would be <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/update">tabs.update()</a>. If you go into your browser’s bar and type in <code>javascript:alert(document.domain)</code>while accessing a website, you should get an alert showing the website’s domain. A XSS used to be possible using <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/update">tabs.update()</a> by doing this exact action programmatically, which has since been patched. Most API Injection attacks lead to DOS attacks or information loss, where an attacker can download an infinite number of files until the disk is full, or create/remove bookmarks to annoy the user, but are not as powerful as the traditional web application primitives.</p>
<h2 id="mitigations">Mitigations<a aria-label="Mitigations" class="heading-link pl-2 text-italic text-bold" href="#mitigations"></a></h2>
<p>I have discussed many mitigations that have come from the transition from v2 to v3 in the respective vulnerability categories above, but I would like to highlight one browser-specific mitigation below.</p>
<h3 id="uuid-randomization">UUID randomization<a aria-label="UUID randomization" class="heading-link pl-2 text-italic text-bold" href="#uuid-randomization"></a></h3>
<p>Now that we understand the attack surface and some common vulnerabilities, we can see what mitigations browser developers have put in place to prevent vulnerabilities. Firstly, many browsers have randomized the ID of the extension, so that attacking exposed HTML files is no longer a threat, unless a leak of the internal ID, called the UUID, can be found.</p>
<p><img><img alt="Screenshot of developer details for the extension FoxyProxy." class="aligncenter size-large wp-image-80695 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="303" loading="lazy" sizes="(max-width: 1000px) 100vw, 1000px" src="https://github.blog/wp-content/uploads/2024/10/image10.png?w=1024&amp;resize=1024%2C303" width="1024"></p>
<p>Here, we can see that all files, such as the manifest, are relative to the Internal UUID. Content scripts can still access the pages by calling <code>browser.runtime.getURL</code>, but this is not possible from within the page itself due to this change. From my testing, both Firefox and Safari randomize this UUID by default, while Chromium does not (at the time of writing this blog). Firefox randomizes based on the container and Safari on application restart. Despite claims both in <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.chrome.com/docs/extensions/reference/manifest/web-accessible-resources">Chromium</a> and MDN docs that the Chromium browser will randomize the UUID if given the key <code>use_dynamic_url</code> in the manifest being in the docs for many years, this  feature was only implemented and enabled by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://issues.chromium.org/issues/324975819">default</a> in August 2024.</p>
<h2 id="modeling-with-codeql">Modeling with CodeQL<a aria-label="Modeling with CodeQL" class="heading-link pl-2 text-italic text-bold" href="#modeling-with-codeql"></a></h2>
<p>Just like many web application vulnerabilities, vulnerabilities in browser extensions can be modeled in CodeQL. CodeQL already has support for many of the vulnerabilities, such as XSS and SSRF, which we can use as the base for our queries. CodeQL’s code injection query gets a RemoteFlowSource (any Javascript APIs that potentially take in data from an external system or user) and looks for flow into Javascript code injection sinks such as eval. These sinks are relevant for browser extensions, but more sinks applicable only to browsers exist. We can create a module of sinks that would apply to browser extensions and extend the Code Injection query’s Sink class to tell CodeQL to consider these sinks.</p>
<pre><code>/**
* Sink for chrome.tabs.executeScript() which may allow an allow arbitrary   * javascript execution.
**/
class ExecuteScript extends DataFlow::Node &#123;
  ExecuteScript() &#123; exists( DataFlow::CallNode c | 
    c = tabsRef().getAMethodCall("executeScript") | (this = c.getArgument(0) and c.getNumArgument() = 1) 
    or
    (this = c.getArgument(1) and c.getNumArgument() = 2 ) )&#125;
&#125;
</code></pre>
<p>Here, we get a dataflow node that corresponds to  <code>browser.tabs</code> and look for the <code>executeScript</code> method. If the method is called with one argument, then it looks for the only argument, but if it has two arguments then the method looks for the second argument, because the first argument is the tabID.</p>
<p><img><img alt="Screenshot of the execute script method" class="aligncenter size-large wp-image-80696 width-fit" data-recalc-dims="1" data-src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" decoding="async" height="315" loading="lazy" sizes="(max-width: 1000px) 100vw, 1000px" src="https://github.blog/wp-content/uploads/2024/10/image2_6190c0.png?w=1024&amp;resize=1024%2C315" width="1024"></p>
<p>When CodeQL is trying to find vulnerabilities in source code, it needs to know how data flows if an external API is called whose implementation is not given. The Chrome APIs sources are not included in a browser extension, therefore we need to model how the foreground script communicates with the background script.</p>
<pre><code>class BrowserStep extends DataFlow::SharedFlowStep &#123;
    override predicate step(DataFlow::Node pred, DataFlow::Node succ) &#123;
      (exists (DataFlow::ParameterNode p |
        pred instanceof BrowserAPI::SendMessage and
        succ = p and 
           p.getParameter() instanceof BrowserAPI::AddListener
      ))
    &#125;
  &#125;

<p>  class ReturnStep extends DataFlow::SharedFlowStep &amp;#123;<br>    override predicate step(DataFlow::Node pred, DataFlow::Node succ) &amp;#123;<br>      (exists (DataFlow::ParameterNode p |<br>        succ instanceof BrowserAPI::SendMessageReturnValue and<br>        pred &#x3D; p.getAnInvocation().getArgument(0) and<br>           p.getParameter() instanceof BrowserAPI::AddListenerReturn<br>      ))<br>    &amp;#125;<br>  &amp;#125;<br></p></code></pre><p></p>
<p>In Javascript CodeQL, we can extend the <code>SharedFlowStep</code> class in order to tell CodeQL that data flows between two data flow nodes. In this first class, I tell CodeQL that data travels between parameter one of <code>sendMessage</code> in the foreground script to the third parameter of the <code>AddListener</code> method in the background script, all in one step. Likewise, the second class models the background script sending a message to the foreground script. With these models in place, we are able to use the Code Injection and CSRF queries to help find XSS and SSRF in browser extensions. CodeQL packs with support for browser extensions are available at our <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/GitHubSecurityLab/CodeQL-Community-Packs">Community Pack repository</a> for developers and researchers to use.</p>
<h2 id="real-world-attack">Real-world attack<a aria-label="Real-world attack" class="heading-link pl-2 text-italic text-bold" href="#real-world-attack"></a></h2>
<p>In this example, I will show how these CodeQL models found a Universal XSS (UXSS) vulnerability in <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/zimocode/smartup">smartup</a>, an extension that has over 100,000 downloads.</p>
<p>Smartup is an extension that allows users to do an action in the browser after a gesture has been taken by the user. The extensions takes untrusted input via onMessageExternal, does a variety of parsing on the message, and eventually processes the message. In one case, apps_test, the extensions uses the <code>chrome.tabs.executeScript</code> v2 API and appends the message property <code>apptype</code> to the code, resulting in XSS. Due to smartup’s broad permission policy (access to all urls or activeTab) and its permissive message receiving policy (arbitrary browser extensions can send it messages), an extension downloaded by the user with no permissions can get UXSS on any website.</p>
<pre><code>chrome.runtime.onMessageExternal.addListener(function(message,sender,sendResponse)&#123;
    sub.funOnMessage(message,sender,sendResponse);
&#125;)
...
case"apps_test":
    let _fun=function()&#123;
        if(message.appjs)&#123;
            chrome.tabs.executeScript(&#123;code:"sue.apps['"+message.apptype+"'].initUI();",runAt:"document_start"&#125;);      &lt;----- message is passed into executeScript
            return;
        &#125;
</code></pre>
<p>This vulnerability may seem serious, but it required three points of failure by the developer (broad permissions, open messaging policy and code injection vulnerability) in order to be fully exploitable. Efforts to inform developers about the importance of security and the risks they take when changing secure defaults should help reduce similar security issues.</p>
<h2 id="conclusion">Conclusion<a aria-label="Conclusion" class="heading-link pl-2 text-italic text-bold" href="#conclusion"></a></h2>
<p>Now that you know the security model of browser extensions, what can you do as a user to ensure that your extensions are secure? First, check the author of your extension and understand that this user has access to all the permissions listed when you install the extensions. Extensions that have not been updated in a while by the author are more likely to be insecure due to usage of old, insecure APIs. Secondly, don’t trust the prompt that pops up when installing an extension, instead open the manifest file and read the permissions to make sure you really understand what is happening. For example, did you know the popup for an extension with the <code>activeTab</code> permission <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.chrome.com/docs/extensions/develop/concepts/activeTab">will not show the presence of the activeTab permission</a>? Understand that, generally speaking, Firefox is less secure due to the lack of requirement for new extensions to have manifest v3, and thus many Firefox extensions are still stuck on v2. If you would like to go further, you can also check the CodeQL queries published at our CodeQL <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/GitHubSecurityLab/CodeQL-Community-Packs/commit/8814182c9c55f974f16dc9dc492cfc248be42185">community packs</a>. in order to check for vulnerabilities. The queries will cover all the vulnerabilities mentioned in this article such as XSS, SSRF, API Injection and include additional best practices alerts.</p>
<div class="post-content-cta"><p><strong>Want to learn more about how GitHub can take the stress out of shipping secure code?</strong><br>
At <a target="_blank" rel="external nofollow noopener noreferrer" href="https://githubuniverse.com/">GitHub Universe 2024</a>, we’ll explore cutting-edge research and best practices in developer-first security—so you can keep your code secure with tools you already know and love.</p>
</div>
</body></html>
<p>The post <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.blog/security/vulnerability-research/attacking-browser-extensions/">Attacking browser extensions</a> appeared first on <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.blog">The GitHub Blog</a>.</p>

</div>

<div>
<div class="tag-plugin link dis-select"><a class="link-card plain" title="Attacking browser extensions" href="https://github.blog/security/vulnerability-research/attacking-browser-extensions/" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="icon"><div class="left"><span class="title">Attacking browser extensions</span><span class="cap link fs12">https://github.blog/security/vulnerability-research/attacking-browser-extensions/</span></div><div class="right"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/link/8f277b4ee0ecd.svg"></div></div></a></div>
</div>




<div class="article-footer reveal fs14"><section id="license"><div class="header"><span>许可协议</span></div><div class="body"><p>本文采用 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/me-shaon/GLWTPL/blob/master/translations/LICENSE_zh-CN">GLWT（Good Luck With That，祝你好运）公共许可证</a> 许可协议，转载请注明出处。</p>
</div></section><section id="share"><div class="header"><span>分享文章</span></div><div class="body"><div class="link"><input class="copy-area" readonly="true" id="copy-link" value="https://blog.imc.re/RSSBOX/rss/7a4438ab.html"></div><div class="social-wrap dis-select"><a class="social share-item wechat" onclick="util.toggle(&quot;qrcode-wechat&quot)"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/social/b32ef3da1162a.svg"></a><a class="social share-item weibo" target="_blank" rel="external nofollow noopener noreferrer" href="https://service.weibo.com/share/share.php?url=https://blog.imc.re/RSSBOX/rss/7a4438ab.html&title=Attacking Browser Extensions - RSSBOX&pics=https://github.blog/wp-content/uploads/2024/10/action-extension.png?w=1024&resize=1024%2C936&summary=


Browser extensions first became mainstream in the early 2000s with their adoption by Firefox and Chromium and thei..."><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/social/80c07e4dbb303.svg"></a><a class="social share-item email" href="mailto:?subject=Attacking Browser Extensions - RSSBOX&amp;body=https://blog.imc.re/RSSBOX/rss/7a4438ab.html"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/social/a1b00e20f425d.svg"></a><a class="social share-item link" onclick="util.copy(&quot;copy-link&quot;, &quot;复制成功&quot;)"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/social/8411ed322ced6.svg"></a></div><div class="qrcode" id="qrcode-wechat" style="visibility:hidden;height:0"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=https://blog.imc.re/RSSBOX/rss/7a4438ab.html"></div></div></section></div>

</article>

<div class="related-wrap reveal" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/RSSBOX/rss/e3e35866.html">《潜水员戴夫》三大联动更新上线，限时史低折扣同步开启</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/RSSBOX/rss/5ae7e223.html">《艾尔登法环》官方美术设定集第3弹12月25日发售</a></div></section></div>


<div class="related-wrap reveal" id="related-posts">
    <section class="header">
      <div class="title cap theme">您可能感兴趣的文章</div>
    </section>
    <section class="body">
    <div class="related-posts"><a class="item" href="/RSSBOX/rss/bfc3cafa.html" title="5 Tips and Tricks When Using GitHub Copilot Workspace"><span class="title">5 Tips and Tricks When Using GitHub Copilot Workspace</span></a><a class="item" href="/RSSBOX/rss/5117513d.html" title="Career Growth, Learning, and Fun, Oh My! Your Guide to GitHub Universe 2024"><span class="title">Career Growth, Learning, and Fun, Oh My! Your Guide to GitHub Universe 2024</span></a><a class="item" href="/RSSBOX/rss/11f80b10.html" title="Cybersecurity Spotlight on Bug Bounty Researcher @Adrianoapj"><span class="title">Cybersecurity Spotlight on Bug Bounty Researcher @Adrianoapj</span></a><a class="item" href="/RSSBOX/rss/b5fc2f2b.html" title="Diversity, Inclusion, and Belonging at GitHub in 2024"><span class="title">Diversity, Inclusion, and Belonging at GitHub in 2024</span></a><a class="item" href="/RSSBOX/rss/85d08535.html" title="GitHub Availability Report: September 2024"><span class="title">GitHub Availability Report: September 2024</span></a></div></section></div>





      
<footer class="page-footer reveal fs12"><hr><div class="sitemap"><div class="sitemap-group"><span class="fs14">文章</span><a href="/RSSBOX/categories">分类</a><a href="/RSSBOX/tags">标签</a><a href="/RSSBOX/archives">归档</a></div><div class="sitemap-group"><span class="fs14">更多</span><a href="https://blog.imc.re/">博客</a><a target="_blank" rel="noopener" href="https://imc.re/">IMC.RE</a></div></div><div class="text"><p><a href="/">@RSSBOX</a> 2023 author by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/MHG-LAB/RSSBOX">MHuiG</a> powered by SummerGoro。<br><br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/me-shaon/GLWTPL/blob/master/translations/LICENSE_zh-CN">GLWT（Good Luck With That，祝你好运）公共许可证</a> 许可协议，转载请注明出处。</p>
</div></footer>

      <div class="float-panel mobile-only blur" style="display:none">
  <button type="button" class="sidebar-toggle mobile" onclick="sidebar.toggle()">
    <svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewbox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"/><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"/></svg>
  </button>
</div>

    </div>
  </div>
  <div class="scripts">
    <script type="text/javascript">
  const stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = stellar.config.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.version = '1.19.0';
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.19.0';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
    root : '/RSSBOX/',
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://gcore.jsdelivr.net/npm/jquery@3.6.2/dist/jquery.min.js'
  };

  if ('local_search') {
    stellar.search = {};
    stellar.search.service = 'local_search';
    if (stellar.search.service == 'local_search') {
      let service_obj = Object.assign({}, {"field":"all","path":"/search.json","content":true,"codeblock":true,"sort":"-date"});
      stellar.search[stellar.search.service] = service_obj;
    }
  }

  // stellar js
  stellar.plugins.stellar = Object.assign({"sites":"/js/plugins/sites.js","friends":"/js/plugins/friends.js","ghinfo":"/js/plugins/ghinfo.js","timeline":"/js/plugins/timeline.js","linkcard":"/js/plugins/linkcard.js","fcircle":"/js/plugins/fcircle.js","weibo":"/js/plugins/weibo.js"});

  stellar.plugins.marked = Object.assign("https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js");
  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.css","js":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.js"});
  }
  if ('' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":null,"js":"https://gcore.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://gcore.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://gcore.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.fancybox = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js","css":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css","selector":".swiper-slide img"});
  }
  if ('false' == 'true') {
    stellar.plugins.heti = Object.assign({"enable":false,"css":"https://unpkg.com/heti@0.9.2/umd/heti.min.css","js":"https://unpkg.com/heti@0.9.2/umd/heti-addon.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.copycode = Object.assign({"enable":true,"js":"/js/plugins/copycode.js","default_text":"Copy","success_text":"Copied"});
  }
</script>

<!-- required -->

  
<script src="/RSSBOX/js/main.js" async></script>



<!-- optional -->

  <script>
  function loadJS() {
    const els = document.querySelectorAll("#comments #giscus");
    if (els.length === 0) return;
    els.forEach((el, i) => {
      try {
        el.innerHTML = '';
      } catch (error) {
        console.log(error);
      }
      var script = document.createElement('script');
      script.src = 'https://giscus.app/client.js';
      script.async = true;
      for (let key of Object.keys(el.attributes)) {
        let attr = el.attributes[key];
        if (['class', 'id'].includes(attr.name) === false) {
          script.setAttribute(attr.name, attr.value);
        }
      }
      el.appendChild(script);
    });
  }
  window.addEventListener('DOMContentLoaded', (event) => {
    loadJS();
  });
</script>




<!-- inject -->


  </div>
</body>
</html>
